This code is taken from www.codescope.com and we have made few changes in it as per our use
